<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯„ã‚Šé“ã®æ•£æ­©ã‚²ãƒ¼ãƒ </title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&display=swap');
        
        body {
            font-family: 'Noto Sans JP', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }
        
        .bounce {
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(-25%);
                animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
            }
            50% {
                transform: translateY(0);
                animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const WalkingGame = () => {
            const [currentScene, setCurrentScene] = useState(0);
            const [playerX, setPlayerX] = useState(400);
            const [playerY, setPlayerY] = useState(300);
            const [isWalking, setIsWalking] = useState(true);
            const [score, setScore] = useState(0);
            const [gameMessage, setGameMessage] = useState('æ•£æ­©ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼');
            const [isDragging, setIsDragging] = useState(false);
            const [collectedItems, setCollectedItems] = useState([]);
            const [gameOver, setGameOver] = useState(false);
            const [collectedInScene, setCollectedInScene] = useState([]);
            const [walkingSpeed] = useState(1.5);

            const gameRef = useRef(null);

            const scenes = [
                {
                    name: "èŠ±ç•‘ã®é“",
                    background: "linear-gradient(to bottom, #87CEEB, #98FB98)",
                    obstacles: [
                        { type: "hole", x: 300, y: 400, width: 80, height: 60 },
                        { type: "hole", x: 500, y: 350, width: 70, height: 50 }
                    ],
                    distractions: [
                        { type: "flower", x: 200, y: 200, emoji: "ğŸŒ¸" },
                        { type: "flower", x: 600, y: 250, emoji: "ğŸŒº" },
                        { type: "butterfly", x: 450, y: 180, emoji: "ğŸ¦‹" }
                    ]
                },
                {
                    name: "æ£®ã®å°é“",
                    background: "linear-gradient(to bottom, #228B22, #32CD32)",
                    obstacles: [
                        { type: "cliff", x: 0, y: 450, width: 200, height: 100 },
                        { type: "hole", x: 400, y: 380, width: 90, height: 70 }
                    ],
                    distractions: [
                        { type: "mushroom", x: 150, y: 300, emoji: "ğŸ„" },
                        { type: "squirrel", x: 550, y: 200, emoji: "ğŸ¿ï¸" },
                        { type: "acorn", x: 350, y: 250, emoji: "ğŸŒ°" }
                    ]
                },
                {
                    name: "å·è¾ºã®é“",
                    background: "linear-gradient(to bottom, #87CEEB, #ADD8E6)",
                    obstacles: [
                        { type: "river", x: 100, y: 400, width: 600, height: 80 },
                        { type: "hole", x: 250, y: 300, width: 60, height: 50 }
                    ],
                    distractions: [
                        { type: "fish", x: 400, y: 440, emoji: "ğŸ " },
                        { type: "stone", x: 180, y: 350, emoji: "ğŸª¨" },
                        { type: "frog", x: 520, y: 380, emoji: "ğŸ¸" }
                    ]
                },
                {
                    name: "å²©å ´ã®é“",
                    background: "linear-gradient(to bottom, #D2691E, #CD853F)",
                    obstacles: [
                        { type: "cliff", x: 600, y: 300, width: 200, height: 200 },
                        { type: "hole", x: 200, y: 400, width: 100, height: 80 },
                        { type: "hole", x: 450, y: 350, width: 80, height: 60 }
                    ],
                    distractions: [
                        { type: "crystal", x: 320, y: 250, emoji: "ğŸ’" },
                        { type: "lizard", x: 150, y: 300, emoji: "ğŸ¦" },
                        { type: "cactus", x: 550, y: 200, emoji: "ğŸŒµ" }
                    ]
                },
                {
                    name: "ãŠèŠ±è¦‹ã®é“",
                    background: "linear-gradient(to bottom, #FFB6C1, #FFC0CB)",
                    obstacles: [
                        { type: "hole", x: 350, y: 380, width: 120, height: 90 },
                        { type: "cliff", x: 0, y: 420, width: 150, height: 80 }
                    ],
                    distractions: [
                        { type: "sakura", x: 200, y: 150, emoji: "ğŸŒ¸" },
                        { type: "sakura", x: 500, y: 200, emoji: "ğŸŒ¸" },
                        { type: "bee", x: 400, y: 250, emoji: "ğŸ" },
                        { type: "picnic", x: 300, y: 300, emoji: "ğŸ§º" }
                    ]
                },
                {
                    name: "å¤•æš®ã‚Œã®é“",
                    background: "linear-gradient(to bottom, #FF6347, #FF7F50)",
                    obstacles: [
                        { type: "hole", x: 250, y: 350, width: 80, height: 70 },
                        { type: "cliff", x: 500, y: 400, width: 300, height: 100 }
                    ],
                    distractions: [
                        { type: "firefly", x: 180, y: 280, emoji: "âœ¨" },
                        { type: "owl", x: 450, y: 200, emoji: "ğŸ¦‰" },
                        { type: "moon", x: 600, y: 150, emoji: "ğŸŒ™" }
                    ]
                },
                {
                    name: "ç ‚æ¼ ã®é“",
                    background: "linear-gradient(to bottom, #F4A460, #DEB887)",
                    obstacles: [
                        { type: "quicksand", x: 200, y: 380, width: 150, height: 100 },
                        { type: "cliff", x: 550, y: 350, width: 250, height: 150 },
                        { type: "hole", x: 400, y: 320, width: 70, height: 60 }
                    ],
                    distractions: [
                        { type: "camel", x: 150, y: 250, emoji: "ğŸª" },
                        { type: "oasis", x: 500, y: 200, emoji: "ğŸï¸" },
                        { type: "snake", x: 350, y: 280, emoji: "ğŸ" }
                    ]
                },
                {
                    name: "é›ªã®é“",
                    background: "linear-gradient(to bottom, #E6E6FA, #F0F8FF)",
                    obstacles: [
                        { type: "ice", x: 300, y: 350, width: 200, height: 120 },
                        { type: "hole", x: 150, y: 400, width: 90, height: 70 }
                    ],
                    distractions: [
                        { type: "snowman", x: 200, y: 250, emoji: "â›„" },
                        { type: "rabbit", x: 450, y: 280, emoji: "ğŸ°" },
                        { type: "icicle", x: 550, y: 200, emoji: "ğŸ§Š" }
                    ]
                },
                {
                    name: "ç«¹æ—ã®é“",
                    background: "linear-gradient(to bottom, #228B22, #90EE90)",
                    obstacles: [
                        { type: "hole", x: 250, y: 380, width: 100, height: 80 },
                        { type: "cliff", x: 500, y: 420, width: 300, height: 80 }
                    ],
                    distractions: [
                        { type: "panda", x: 180, y: 280, emoji: "ğŸ¼" },
                        { type: "bamboo", x: 400, y: 200, emoji: "ğŸ‹" },
                        { type: "dragonfly", x: 350, y: 250, emoji: "ğŸª°" }
                    ]
                },
                {
                    name: "ã‚´ãƒ¼ãƒ«åœ°ç‚¹",
                    background: "linear-gradient(to bottom, #FFD700, #FFA500)",
                    obstacles: [
                        { type: "final_pit", x: 350, y: 400, width: 150, height: 80 }
                    ],
                    distractions: [
                        { type: "treasure", x: 400, y: 250, emoji: "ğŸ†" },
                        { type: "rainbow", x: 300, y: 150, emoji: "ğŸŒˆ" },
                        { type: "celebration", x: 200, y: 200, emoji: "ğŸ‰" }
                    ]
                }
            ];

            // Reset collected items when scene changes
            useEffect(() => {
                setCollectedInScene([]);
            }, [currentScene]);

            useEffect(() => {
                let interval;
                if (isWalking && !gameOver) {
                    interval = setInterval(() => {
                        setPlayerX(prev => {
                            const newX = prev + walkingSpeed;
                            
                            // Check for obstacles with current position
                            const scene = scenes[currentScene];
                            let hitObstacle = false;
                            
                            scene.obstacles.forEach(obstacle => {
                                if (newX >= obstacle.x && newX <= obstacle.x + obstacle.width &&
                                    playerY >= obstacle.y && playerY <= obstacle.y + obstacle.height) {
                                    const obstacleNames = {
                                        hole: "ç©´",
                                        cliff: "å´–", 
                                        river: "å·",
                                        quicksand: "æµç ‚",
                                        ice: "æ°·",
                                        final_pit: "æœ€å¾Œã®è½ã¨ã—ç©´"
                                    };
                                    setGameMessage(`${obstacleNames[obstacle.type] || obstacle.type}ã«è½ã¡ãŸï¼ãƒ‰ãƒ©ãƒƒã‚°ã§æˆ»ã—ã¦ï¼`);
                                    setIsWalking(false);
                                    hitObstacle = true;
                                }
                            });
                            
                            if (hitObstacle) return prev;
                            
                            if (newX > 750) {
                                if (currentScene < scenes.length - 1) {
                                    setCurrentScene(prev => prev + 1);
                                    setGameMessage(`${scenes[currentScene + 1]?.name}ã«åˆ°ç€ï¼`);
                                    return 50;
                                } else {
                                    setGameMessage("ãŠã‚ã§ã¨ã†ï¼ã‚´ãƒ¼ãƒ«ã§ã™ï¼ğŸ‰");
                                    setIsWalking(false);
                                    setGameOver(true);
                                    return prev;
                                }
                            }
                            return newX;
                        });
                    }, 50);
                }
                return () => clearInterval(interval);
            }, [isWalking, currentScene, playerY, gameOver]);

            const handleMouseDown = (e) => {
                setIsDragging(true);
            };

            const handleMouseMove = (e) => {
                if (isDragging) {
                    const rect = gameRef.current.getBoundingClientRect();
                    const newX = e.clientX - rect.left;
                    const newY = e.clientY - rect.top;
                    
                    setPlayerX(Math.max(50, Math.min(750, newX)));
                    setPlayerY(Math.max(150, Math.min(450, newY)));
                    
                    if (newY < 350) {
                        setGameMessage("é“ã«æˆ»ã‚Šã¾ã—ãŸï¼");
                        setIsWalking(true);
                    }
                }
            };

            const handleMouseUp = () => {
                setIsDragging(false);
            };

            const handleTouchStart = (e) => {
                e.preventDefault();
                setIsDragging(true);
            };

            const handleTouchMove = (e) => {
                e.preventDefault();
                if (isDragging) {
                    const touch = e.touches[0];
                    const rect = gameRef.current.getBoundingClientRect();
                    const newX = touch.clientX - rect.left;
                    const newY = touch.clientY - rect.top;
                    
                    setPlayerX(Math.max(50, Math.min(750, newX)));
                    setPlayerY(Math.max(150, Math.min(450, newY)));
                    
                    if (newY < 350) {
                        setGameMessage("é“ã«æˆ»ã‚Šã¾ã—ãŸï¼");
                        setIsWalking(true);
                    }
                }
            };

            const handleTouchEnd = (e) => {
                e.preventDefault();
                setIsDragging(false);
            };

            const collectItem = (item, index) => {
                if (collectedInScene.includes(index)) return; // Already collected
                
                const newItems = [...collectedItems, item];
                setCollectedItems(newItems);
                setCollectedInScene(prev => [...prev, index]);
                setScore(prev => prev + 10);
                
                const itemNames = {
                    flower: "ãŠèŠ±", butterfly: "è¶ã€…", mushroom: "ãã®ã“", squirrel: "ãƒªã‚¹",
                    acorn: "ã©ã‚“ãã‚Š", fish: "é­š", stone: "çŸ³", frog: "ã‚«ã‚¨ãƒ«",
                    crystal: "æ°´æ™¶", lizard: "ãƒˆã‚«ã‚²", cactus: "ã‚µãƒœãƒ†ãƒ³", sakura: "æ¡œ",
                    bee: "èœ‚", picnic: "ãŠå¼å½“", firefly: "ãƒ›ã‚¿ãƒ«", owl: "ãƒ•ã‚¯ãƒ­ã‚¦",
                    moon: "ãŠæœˆæ§˜", camel: "ãƒ©ã‚¯ãƒ€", oasis: "ã‚ªã‚¢ã‚·ã‚¹", snake: "ãƒ˜ãƒ“",
                    snowman: "é›ªã ã‚‹ã¾", rabbit: "ã‚¦ã‚µã‚®", icicle: "ã¤ã‚‰ã‚‰", panda: "ãƒ‘ãƒ³ãƒ€",
                    bamboo: "ç«¹", dragonfly: "ãƒˆãƒ³ãƒœ", treasure: "å®ç‰©", rainbow: "è™¹",
                    celebration: "ãŠç¥ã„"
                };
                
                setGameMessage(`${item.emoji} ${itemNames[item.type] || item.type}ã‚’è¦‹ã¤ã‘ãŸï¼+10ç‚¹`);
            };

            const restartGame = () => {
                setCurrentScene(0);
                setPlayerX(400);
                setPlayerY(300);
                setIsWalking(true);
                setScore(0);
                setGameMessage('æ•£æ­©ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼');
                setIsDragging(false);
                setCollectedItems([]);
                setGameOver(false);
                setCollectedInScene([]);
            };

            const currentSceneData = scenes[currentScene];

            return (
                <div className="game-container">
                    <div className="mb-4 text-white text-center">
                        <h1 className="text-4xl font-bold mb-4 text-shadow">ğŸš¶â€â™‚ï¸ å¯„ã‚Šé“ã®æ•£æ­©ã‚²ãƒ¼ãƒ  ğŸŒ¸</h1>
                        <div className="flex justify-center gap-6 text-lg bg-black bg-opacity-30 p-3 rounded-lg">
                            <div className="font-semibold">ã‚·ãƒ¼ãƒ³: {currentScene + 1}/10</div>
                            <div className="font-semibold">ğŸ“ {currentSceneData.name}</div>
                            <div className="font-semibold">ğŸ¯ ã‚¹ã‚³ã‚¢: {score}</div>
                            <div className="font-semibold">ğŸ åé›†: {collectedItems.length}å€‹</div>
                        </div>
                    </div>

                    <div 
                        ref={gameRef}
                        className="relative border-4 border-white rounded-lg overflow-hidden cursor-crosshair shadow-2xl"
                        style={{ 
                            width: '800px', 
                            height: '500px',
                            background: currentSceneData.background 
                        }}
                        onMouseDown={handleMouseDown}
                        onMouseMove={handleMouseMove}
                        onMouseUp={handleMouseUp}
                        onTouchStart={handleTouchStart}
                        onTouchMove={handleTouchMove}
                        onTouchEnd={handleTouchEnd}
                    >
                        {/* Path */}
                        <div className="absolute top-0 left-0 w-full h-[350px] bg-gradient-to-b from-transparent to-yellow-200 opacity-30"></div>
                        
                        {/* Obstacles */}
                        {currentSceneData.obstacles.map((obstacle, index) => (
                            <div
                                key={index}
                                className={`absolute border-2 border-red-600 ${
                                    obstacle.type === 'hole' ? 'bg-black rounded-full' :
                                    obstacle.type === 'cliff' ? 'bg-gray-600' :
                                    obstacle.type === 'river' ? 'bg-blue-400' :
                                    obstacle.type === 'quicksand' ? 'bg-yellow-600' :
                                    obstacle.type === 'ice' ? 'bg-blue-200' :
                                    obstacle.type === 'final_pit' ? 'bg-red-800' :
                                    'bg-gray-500'
                                }`}
                                style={{
                                    left: obstacle.x + 'px',
                                    top: obstacle.y + 'px',
                                    width: obstacle.width + 'px',
                                    height: obstacle.height + 'px'
                                }}
                            >
                                <div className="text-center text-white text-xs font-bold p-1">
                                    {obstacle.type === 'hole' && 'ç©´'}
                                    {obstacle.type === 'cliff' && 'å´–'}
                                    {obstacle.type === 'river' && 'å·'}
                                    {obstacle.type === 'quicksand' && 'æµç ‚'}
                                    {obstacle.type === 'ice' && 'æ°·'}
                                    {obstacle.type === 'final_pit' && 'è½ç©´'}
                                </div>
                            </div>
                        ))}

                        {/* Distractions */}
                        {currentSceneData.distractions.map((item, index) => {
                            if (collectedInScene.includes(index)) return null;
                            return (
                                <div
                                    key={index}
                                    className="absolute cursor-pointer hover:scale-125 transition-transform"
                                    style={{ 
                                        left: item.x + 'px', 
                                        top: item.y + 'px' 
                                    }}
                                    onClick={() => collectItem(item, index)}
                                >
                                    <div className="text-4xl pulse">{item.emoji}</div>
                                </div>
                            );
                        })}

                        {/* Player */}
                        <div
                            className="absolute text-4xl transition-all duration-200 z-10"
                            style={{ 
                                left: (playerX - 20) + 'px', 
                                top: (playerY - 20) + 'px',
                                transform: isDragging ? 'scale(1.3)' : 'scale(1)'
                            }}
                        >
                            ğŸš¶â€â™‚ï¸
                        </div>

                        {/* Collected items display */}
                        <div className="absolute top-2 right-2 bg-black bg-opacity-70 text-white p-3 rounded-lg">
                            <div className="text-sm font-bold mb-1">åé›†ã—ãŸã‚¢ã‚¤ãƒ†ãƒ :</div>
                            <div className="flex flex-wrap gap-1 max-w-[200px]">
                                {collectedItems.slice(-12).map((item, index) => (
                                    <span key={index} className="text-2xl">{item.emoji}</span>
                                ))}
                            </div>
                        </div>

                        {/* Progress bar */}
                        <div className="absolute bottom-2 left-2 right-2 h-3 bg-black bg-opacity-30 rounded-full">
                            <div 
                                className="h-full bg-green-400 rounded-full transition-all duration-300"
                                style={{ width: ((currentScene + 1) / scenes.length * 100) + '%' }}
                            ></div>
                        </div>
                    </div>

                    {/* Game message */}
                    <div className="mt-4 text-white text-center bg-black bg-opacity-50 p-6 rounded-lg max-w-[800px]">
                        <div className="text-2xl font-bold mb-2">{gameMessage}</div>
                        <div className="text-base text-gray-300">
                            {gameOver ? "ğŸ‰ ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢ï¼ç´ æ™´ã‚‰ã—ã„æ•£æ­©ã§ã—ãŸï¼" :
                             isWalking ? "ğŸš¶â€â™‚ï¸ è‡ªå‹•ã§æ­©ã„ã¦ã„ã¾ã™ã€‚å¯„ã‚Šé“ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦åé›†ã—ã‚ˆã†ï¼" : 
                             "ğŸ‘† æŒ‡ã§ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦é“ã«æˆ»ã—ã¦ãã ã•ã„ï¼"}
                        </div>
                        {gameOver && (
                            <div className="mt-4">
                                <button 
                                    className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg text-xl transition-colors bounce"
                                    onClick={restartGame}
                                >
                                    ğŸ”„ ã‚‚ã†ä¸€åº¦æ•£æ­©ã™ã‚‹
                                </button>
                            </div>
                        )}
                    </div>

                    {/* Instructions */}
                    <div className="mt-4 text-white text-center max-w-[800px] bg-black bg-opacity-30 p-4 rounded-lg">
                        <div className="text-lg font-semibold mb-2">ğŸ® éŠã³æ–¹</div>
                        <div className="text-sm space-y-1">
                            <div>ğŸ‘† ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¯è‡ªå‹•ã§æ­©ãã¾ã™ã€‚ç©´ã‚„å´–ã«è½ã¡ãŸã‚‰ã€ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦é“ã«æˆ»ã—ã¾ã—ã‚‡ã†ï¼</div>
                            <div>âœ¨ å¯„ã‚Šé“è¦ç´ ï¼ˆèŠ±ã€è™«ã€çŸ³ãªã©ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦åé›†ã™ã‚‹ã¨ã‚¹ã‚³ã‚¢ãŒã‚¢ãƒƒãƒ—ã—ã¾ã™ï¼</div>
                            <div>ğŸ† 10ã®ã‚·ãƒ¼ãƒ³ã‚’å…¨ã¦ã‚¯ãƒªã‚¢ã—ã¦ã‚´ãƒ¼ãƒ«ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ï¼</div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<WalkingGame />, document.getElementById('root'));
    </script>
</body>
</html>
